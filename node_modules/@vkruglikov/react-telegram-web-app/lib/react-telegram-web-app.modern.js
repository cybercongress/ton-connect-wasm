import n,{createContext as e,useContext as o,useEffect as t,useId as l,useCallback as r,useState as u,useMemo as i}from"react";var s;const c="undefined"!=typeof window&&null!=(s=window)&&null!=(s=s.Telegram)&&s.WebApp?window.Telegram.WebApp:null,a=e(c),d={smoothButtonsTransition:!1,smoothButtonsTransitionMs:10},h=e(d),v=()=>({MainButton:{current:null},BackButton:{current:null}}),p=e({MainButton:{current:null},BackButton:{current:null}}),m=()=>{},w=({id:n,show:e=m,hide:l=m,currentShowedIdRef:r})=>{const{smoothButtonsTransition:u,smoothButtonsTransitionMs:i}=o(h);t(()=>(e(),r.current=n,()=>{u?(r.current=null,setTimeout(()=>{r.current||l()},i)):(l(),r.current=null)}),[l,n,r,e,u,i])},f=()=>o(a),B=({text:n="CONTINUE",progress:e=!1,disable:r,disabled:u=!1,color:i,textColor:s,onClick:c})=>{const a=o(p),d=l(),h=f(),v=null==h?void 0:h.MainButton,m=null==h?void 0:h.themeParams,B=r||u;return t(()=>{null==v||v.setParams({color:i||(null==m?void 0:m.button_color)||"#fff"})},[i,m,v]),t(()=>{null==v||v.setParams({text_color:s||(null==m?void 0:m.button_text_color)||"#000"})},[v,m,s]),t(()=>{null==v||v.setText(n)},[n,v]),t(()=>{B?null==v||v.disable():B||null==v||v.enable()},[B,v]),t(()=>{e?null==v||v.showProgress(!1):e||null==v||v.hideProgress()},[e,v]),t(()=>{if(c)return null==v||v.onClick(c),()=>{null==v||v.offClick(c)}},[c,v]),w({show:null==v?void 0:v.show,hide:null==v?void 0:v.hide,currentShowedIdRef:a.MainButton,id:d}),null},P=({onClick:n})=>{const e=o(p),r=l(),u=f(),i=null==u?void 0:u.BackButton;return t(()=>{if(n&&i)return i.onClick(n),()=>{i.offClick(n)}},[n,i]),w({show:null==i?void 0:i.show,hide:null==i?void 0:i.hide,currentShowedIdRef:e.BackButton,id:r}),null},b=()=>{const n=f();return r(e=>new Promise((o,t)=>{try{null==n||null==n.showPopup||n.showPopup(e,n=>{o(n)})}catch(n){t(n)}}),[n])},C=()=>{const n=f(),e=null==n?void 0:n.HapticFeedback;return[r((...n)=>null==e?void 0:e.impactOccurred(...n),[e]),r((...n)=>null==e?void 0:e.notificationOccurred(...n),[e]),r((...n)=>null==e?void 0:e.selectionChanged(...n),[e])]},g=()=>{const n=f(),[e,o]=u(null==n?void 0:n.colorScheme),[l,r]=u((null==n?void 0:n.themeParams)||{});return t(()=>{if(!n)return;const e=()=>{o(n.colorScheme),r(n.themeParams)};return n.onEvent("themeChanged",e),()=>{n.offEvent("themeChanged",e)}},[n]),[e,l]},T=()=>{const n=f();return[r((...e)=>null==n||null==n.showScanQrPopup?void 0:n.showScanQrPopup(...e),[n]),r(()=>null==n||null==n.closeScanQrPopup?void 0:n.closeScanQrPopup(),[n])]},k=()=>{const n=f();return r(()=>new Promise(e=>{null==n||null==n.readTextFromClipboard||n.readTextFromClipboard(e)}),[n])},x=()=>{const n=f();return r((...e)=>null==n||null==n.switchInlineQuery?void 0:n.switchInlineQuery(...e),[n])},E=()=>{const n=f(),[e,o]=u(null==n?void 0:n.isExpanded);return t(()=>{if(!n)return;const e=e=>{e.isStateStable&&o(n.isExpanded)};return n.onEvent("viewportChanged",e),()=>n.offEvent("viewportChanged",e)},[n]),[e,r(()=>null==n||null==n.expand?void 0:n.expand(),[n])]};function S(){return S=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(n[t]=o[t])}return n},S.apply(this,arguments)}const y=({children:e,options:o})=>{const l=i(()=>S({},d,o),[o]),r=i(v,[]);return t(()=>{if(null==o||!o.smoothButtonsTransition)return;const n=()=>{var n,e;null==c||null==(n=c.MainButton)||n.hide(),null==c||null==(e=c.BackButton)||e.hide()};return window.addEventListener("beforeunload",n),()=>window.removeEventListener("beforeunload",n)},[null==o?void 0:o.smoothButtonsTransition]),n.createElement(p.Provider,{value:r},n.createElement(a.Provider,{value:c},n.createElement(h.Provider,{value:l},e)))};export{P as BackButton,B as MainButton,y as WebAppProvider,E as useExpand,C as useHapticFeedback,k as useReadTextFromClipboard,T as useScanQrPopup,b as useShowPopup,x as useSwitchInlineQuery,g as useThemeParams};

import n,{createContext as t,useContext as o,useEffect as u,useId as e,useCallback as r,useState as l,useMemo as i}from"react";var c,a="undefined"!=typeof window&&null!=(c=window)&&null!=(c=c.Telegram)&&c.WebApp?window.Telegram.WebApp:null,d=t(a),f={smoothButtonsTransition:!1,smoothButtonsTransitionMs:10},s=t(f),v=function(){return{MainButton:{current:null},BackButton:{current:null}}},h=t({MainButton:{current:null},BackButton:{current:null}}),p=function(){},m=function(n){var t=n.id,e=n.show,r=void 0===e?p:e,l=n.hide,i=void 0===l?p:l,c=n.currentShowedIdRef,a=o(s),d=a.smoothButtonsTransition,f=a.smoothButtonsTransitionMs;u(function(){return r(),c.current=t,function(){d?(c.current=null,setTimeout(function(){c.current||i()},f)):(i(),c.current=null)}},[i,t,c,r,d,f])},w=function(){return o(d)},B=function(n){var t=n.text,r=void 0===t?"CONTINUE":t,l=n.progress,i=void 0!==l&&l,c=n.disable,a=n.disabled,d=void 0!==a&&a,f=n.color,s=n.textColor,v=n.onClick,p=o(h),B=e(),P=w(),b=null==P?void 0:P.MainButton,C=null==P?void 0:P.themeParams,g=c||d;return u(function(){null==b||b.setParams({color:f||(null==C?void 0:C.button_color)||"#fff"})},[f,C,b]),u(function(){null==b||b.setParams({text_color:s||(null==C?void 0:C.button_text_color)||"#000"})},[b,C,s]),u(function(){null==b||b.setText(r)},[r,b]),u(function(){g?null==b||b.disable():g||null==b||b.enable()},[g,b]),u(function(){i?null==b||b.showProgress(!1):i||null==b||b.hideProgress()},[i,b]),u(function(){if(v)return null==b||b.onClick(v),function(){null==b||b.offClick(v)}},[v,b]),m({show:null==b?void 0:b.show,hide:null==b?void 0:b.hide,currentShowedIdRef:p.MainButton,id:B}),null},P=function(n){var t=n.onClick,r=o(h),l=e(),i=w(),c=null==i?void 0:i.BackButton;return u(function(){if(t&&c)return c.onClick(t),function(){c.offClick(t)}},[t,c]),m({show:null==c?void 0:c.show,hide:null==c?void 0:c.hide,currentShowedIdRef:r.BackButton,id:l}),null},b=function(){var n=w();return r(function(t){return new Promise(function(o,u){try{null==n||null==n.showPopup||n.showPopup(t,function(n){o(n)})}catch(n){u(n)}})},[n])},C=function(){var n=w(),t=null==n?void 0:n.HapticFeedback,o=r(function(){return null==t?void 0:t.impactOccurred.apply(t,[].slice.call(arguments))},[t]),u=r(function(){return null==t?void 0:t.notificationOccurred.apply(t,[].slice.call(arguments))},[t]),e=r(function(){return null==t?void 0:t.selectionChanged.apply(t,[].slice.call(arguments))},[t]);return[o,u,e]},g=function(){var n=w(),t=l(null==n?void 0:n.colorScheme),o=t[0],e=t[1],r=l((null==n?void 0:n.themeParams)||{}),i=r[0],c=r[1];return u(function(){if(n){var t=function(){e(n.colorScheme),c(n.themeParams)};return n.onEvent("themeChanged",t),function(){n.offEvent("themeChanged",t)}}},[n]),[o,i]},T=function(){var n=w(),t=r(function(){return null==n||null==n.showScanQrPopup?void 0:n.showScanQrPopup.apply(n,[].slice.call(arguments))},[n]);return[t,r(function(){return null==n||null==n.closeScanQrPopup?void 0:n.closeScanQrPopup()},[n])]},k=function(){var n=w();return r(function(){return new Promise(function(t){null==n||null==n.readTextFromClipboard||n.readTextFromClipboard(t)})},[n])},x=function(){var n=w();return r(function(){return null==n||null==n.switchInlineQuery?void 0:n.switchInlineQuery.apply(n,[].slice.call(arguments))},[n])},y=function(){var n=w(),t=l(null==n?void 0:n.isExpanded),o=t[0],e=t[1];return u(function(){if(n){var t=function(t){t.isStateStable&&e(n.isExpanded)};return n.onEvent("viewportChanged",t),function(){return n.offEvent("viewportChanged",t)}}},[n]),[o,r(function(){return null==n||null==n.expand?void 0:n.expand()},[n])]};function E(){return E=Object.assign?Object.assign.bind():function(n){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var u in o)Object.prototype.hasOwnProperty.call(o,u)&&(n[u]=o[u])}return n},E.apply(this,arguments)}var S=function(t){var o=t.children,e=t.options,r=i(function(){return E({},f,e)},[e]),l=i(v,[]);return u(function(){if(null!=e&&e.smoothButtonsTransition){var n=function(){var n,t;null==a||null==(n=a.MainButton)||n.hide(),null==a||null==(t=a.BackButton)||t.hide()};return window.addEventListener("beforeunload",n),function(){return window.removeEventListener("beforeunload",n)}}},[null==e?void 0:e.smoothButtonsTransition]),n.createElement(h.Provider,{value:l},n.createElement(d.Provider,{value:a},n.createElement(s.Provider,{value:r},o)))};export{P as BackButton,B as MainButton,S as WebAppProvider,y as useExpand,C as useHapticFeedback,k as useReadTextFromClipboard,T as useScanQrPopup,b as useShowPopup,x as useSwitchInlineQuery,g as useThemeParams};

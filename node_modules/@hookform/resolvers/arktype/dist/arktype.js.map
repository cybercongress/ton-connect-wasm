{"version":3,"file":"arktype.js","sources":["../src/arktype.ts"],"sourcesContent":["import { FieldError, FieldErrors } from 'react-hook-form';\nimport { toNestErrors, validateFieldsNatively } from '@hookform/resolvers';\nimport type { Resolver } from './types';\nimport { Problems } from 'arktype';\n\nconst parseErrorSchema = (e: Problems) => {\n  const errors: Record<string, FieldError> = {};\n  for (; e.length; ) {\n    const error = e[0];\n    const _path = error.path.join('.');\n\n    if (!errors[_path]) {\n      errors[_path] = { message: error.message, type: error.code };\n    }\n\n    // @ts-expect-error - false positive Property 'shift' does not exist on type 'Problems'.\n    e.shift();\n  }\n\n  return errors;\n};\n\nexport const arktypeResolver: Resolver =\n  (schema, _schemaOptions, resolverOptions = {}) =>\n  (values, _, options) => {\n    const result = schema(values);\n\n    if (result.problems) {\n      return {\n        values: {},\n        errors: toNestErrors(parseErrorSchema(result.problems), options),\n      };\n    }\n\n    options.shouldUseNativeValidation && validateFieldsNatively({}, options);\n\n    return {\n      errors: {} as FieldErrors,\n      values: resolverOptions.raw ? values : result.data,\n    };\n  };\n"],"names":["parseErrorSchema","e","errors","length","error","_path","path","join","message","type","code","shift","schema","_schemaOptions","resolverOptions","values","_","options","result","problems","toNestErrors","shouldUseNativeValidation","validateFieldsNatively","raw","data"],"mappings":"qCAKMA,EAAmB,SAACC,GAExB,IADA,IAAMC,EAAqC,GACpCD,EAAEE,QAAU,CACjB,IAAMC,EAAQH,EAAE,GACVI,EAAQD,EAAME,KAAKC,KAAK,KAEzBL,EAAOG,KACVH,EAAOG,GAAS,CAAEG,QAASJ,EAAMI,QAASC,KAAML,EAAMM,OAIxDT,EAAEU,OACH,CAED,OAAOT,CACT,0BAGE,SAACU,EAAQC,EAAgBC,GAAoB,gBAApBA,IAAAA,EAAkB,CAAE,YAC5CC,EAAQC,EAAGC,GACV,IAAMC,EAASN,EAAOG,GAEtB,OAAIG,EAAOC,SACF,CACLJ,OAAQ,CAAA,EACRb,OAAQkB,EAAYA,aAACpB,EAAiBkB,EAAOC,UAAWF,KAI5DA,EAAQI,2BAA6BC,EAAsBA,uBAAC,GAAIL,GAEzD,CACLf,OAAQ,CAAiB,EACzBa,OAAQD,EAAgBS,IAAMR,EAASG,EAAOM,MAElD,CAAC"}